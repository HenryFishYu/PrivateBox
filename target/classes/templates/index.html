<!DOCTYPE html>
<#import "spring.ftl" as spring/>
<#include "common.ftl">  
<@header title="PrivateBox">  
</@header>
<html>
<head>
    <meta charset="UTF-8"></meta>
    <script>
     $(document).ready(function(){
    	 var headers = {};
	    	headers['X-CSRF-TOKEN'] = "${_csrf.token}";
	    	$(document).keydown(function(event){
	    	　　　　if(event.keyCode==13){
	    			$("#login-button").click();
	    	　　　　}
	    	　　});
	    $("#register-button").click(function(){

	    	$.ajax({
	    	    url: "/user/register",
	    	    data:{
	    	    	username:$("#register-name").val(),
	    	    	sha512Password:$("#register-password").val(),
	    	    	invitationCode:$("#register-invitation-code").val()
	    	    },
	    	    type: "POST",
	    	    headers: headers,
	    	    dataType: "json",
	    	    success: function(result) {
	    	    	if(result.error=="Success"){
	    	    		cleanRegisterForm();
	    	    	}
	    	    	$.messager.alert('提示', result.message, 'info');
	    	    },
	    	    error:function(result){
	    	    	$.messager.alert('提示', result.message, 'info');
	    	    }
	    	});
	    });
	    function cleanRegisterForm(){
	    	$(".register").val('');
	    }
     });
    </script>
    <style type="text/css">
    </style>
</head>
<body>
<div id="login-div">
<form id="login-form" method="post" action="/login">
<@spring.message 'username' />:<input type="text" name="username" id="login-name" /><br />
<@spring.message 'password' />:<input type="password" name="password" id="login-password" /><br />
<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
<input type="submit" id="login-button" value="<@spring.message 'login' />" /> 
</form>
</div>
<#if loginError??>
<@spring.message 'loginError' />
<#else>
</#if>
<div id="register-div">
<@spring.message 'username' />:<input type="text" class="register" id="register-name" /><br />
<@spring.message 'password' />:<input type="password" class="register" id="register-password" /><br />
<@spring.message 'invitationCode' />:<input type="text" class="register" id="register-invitation-code" /><br />
<input type="button" id="register-button" value="<@spring.message 'register' />"/> 
</div>
<a href="/?language=en_US">English(US)</a>
<a href="/?language=zh_CN">简体中文</a> <br />
</body>
</html>